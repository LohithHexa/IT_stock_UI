<div style="text-align: center; margin-bottom: 10px;">
  <h3 style="margin: 0;">Indian IT Companies Stock Price Information – NSE</h3>
</div>

<!-- Company Selector as Checkboxes -->
<div style="margin-bottom: 12px; text-align: center;">
  <label style="font-weight: 600;">Select Companies:</label>
  <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 12px; margin-top: 8px;">
    <div *ngFor="let item of financials" style="display: flex; align-items: center;">
      <input
        type="checkbox"
        [value]="item.companyName"
        (change)="onCheckboxChange($event, item.companyName)"
        [checked]="selectedCompanies.includes(item.companyName)"
        [id]="item.companyName"
      />
      <label [for]="item.companyName" style="margin-left: 4px;">
        {{ item.companyName }}
      </label>
    </div>
  </div>
</div>

<!-- Floating Metric Dropdown -->
<!-- Floating Metric Dropdown -->
<div style="margin-bottom: 12px; margin-left: 12px;">
  <div class="dropdown-trigger" (click)="toggleMetricDropdown()" style="cursor: pointer; font-weight: bold; background-color: #e0e0e0; padding: 6px 12px; border-radius: 4px; display: inline-block;">
    Select Metrics ▼
  </div>

  <div
    class="dropdown-menu"
    *ngIf="showMetricDropdown"
    (click)="$event.stopPropagation()"
    style="position: absolute; background-color: #fff; border: 1px solid #ccc; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15); padding: 8px; min-width: 160px; max-height: 200px; overflow-y: auto; z-index: 1000;"
  >
    <div class="dropdown-content" style="display: flex; flex-direction: column; gap: 6px;">
      
      <!-- Select All Checkbox -->
      <div class="dropdown-item" style="display: flex; align-items: center; gap: 6px;">
        <input
          type="checkbox"
          [checked]="selectedMetrics.length === availableMetrics.length"
          (change)="toggleSelectAll($event)"
          id="selectAllMetrics"
        />
        <label for="selectAllMetrics"><strong>Select All</strong></label>
      </div>

      <!-- Individual Metric Checkboxes -->
      <div *ngFor="let metric of availableMetrics" class="dropdown-item" style="display: flex; align-items: center; gap: 6px;">
        <input
          type="checkbox"
          [checked]="selectedMetrics.includes(metric)"
          (change)="onMetricToggle(metric)"
          [id]="metric"
        />
        <label [for]="metric">{{ metric }}</label>
      </div>
    </div>
  </div>
</div>

<!-- Scrollable Table with Sticky Metric Column -->
<div class="table-wrapper">
  <table class="transposed-table">
    <thead>
      <tr>
        <th class="sticky-metric">Metric</th>
        <ng-container *ngFor="let item of financials; let i = index">
          <ng-container *ngIf="selectedCompanies.includes(item.companyName)">
            <th [ngClass]="'company-' + i" style="text-align: center;">
              {{ item.companyName }}
            </th>
          </ng-container>
        </ng-container>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let metric of availableMetrics">
        <ng-container *ngIf="selectedMetrics.includes(metric)">
          <td class="sticky-metric">{{ metric }}</td>
          <ng-container *ngFor="let item of financials; let i = index">
            <ng-container *ngIf="selectedCompanies.includes(item.companyName)">
              <td [ngClass]="'company-' + i" style="text-align: right;">
                {{ getMetricValue(item, metric) }}
              </td>
            </ng-container>
          </ng-container>
        </ng-container>
      </tr>
    </tbody>
  </table>
</div>